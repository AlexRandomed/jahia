<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd">
       
    <bean class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">
        <property name="mappings">
            <value>
                /**/acl.gwt=aclServiceController
                /**/base.gwt=baseServiceController
                /**/contentLegacy.gwt=contentLegacyServiceController
                /**/contentDefinition.gwt=contentDefinitionServiceController
                /**/layoutmanager.gwt=layoutServiceController
                /**/contentManager.gwt=contentManagerServiceController
                /**/opensearch.gwt=openSearchServiceController
                /**/pdisplay.gwt=pdisplayServiceController
                /**/sessionManager.gwt=sessionManagerServiceController
                /**/subscription.gwt=subscriptionServiceController
                /**/toolbar.gwt=toolbarServiceController
                /**/userManager.gwt=userManagerServiceController
            </value>
        </property>
    </bean>
    
    <bean name="aclServiceController" class="org.jahia.ajax.gwt.commons.server.GWTController">
        <property name="remoteServiceName" value="gwtACLService"/>
    </bean>
    <bean name="gwtACLService" class="org.jahia.ajax.gwt.aclmanagement.server.ACLServiceImpl" scope="prototype">
        <property name="acl" ref="ACLHelper"/>
    </bean>

    <bean name="baseServiceController" class="org.jahia.ajax.gwt.commons.server.GWTController">
        <property name="remoteServiceName" value="gwtJahiaService"/>
    </bean>
    <bean name="gwtJahiaService" class="org.jahia.ajax.gwt.commons.server.rpc.JahiaServiceImpl" scope="prototype"/>

    <bean name="contentLegacyServiceController" class="org.jahia.ajax.gwt.commons.server.GWTController">
        <property name="remoteServiceName" value="gwtJahiaContentLegacyService"/>
    </bean>
    <bean name="gwtJahiaContentLegacyService" class="org.jahia.ajax.gwt.commons.server.rpc.JahiaContentLegacyServiceImpl" scope="prototype"/>

    <bean name="contentDefinitionServiceController" class="org.jahia.ajax.gwt.commons.server.GWTController">
        <property name="remoteServiceName" value="gwtJahiaContentDefinitionService"/>
    </bean>
    <bean name="gwtJahiaContentDefinitionService" class="org.jahia.ajax.gwt.definitions.server.JahiaContentDefinitionServiceImpl" scope="prototype">
        <property name="contentDefinition" ref="ContentDefinitionHelper"/>
    </bean>

    <bean name="layoutServiceController" class="org.jahia.ajax.gwt.commons.server.GWTController">
        <property name="remoteServiceName" value="gwtJahiaLayoutService"/>
    </bean>
    <bean name="gwtJahiaLayoutService" class="org.jahia.ajax.gwt.templates.components.layoutmanager.server.LayoutmanagerServiceImpl" scope="prototype">
        <property name="sessionFactory" ref="jcrSessionFactory"/>
        <property name="navigation" ref="NavigationHelper"/>
    </bean>

    <bean name="contentManagerServiceController" class="org.jahia.ajax.gwt.commons.server.GWTController">
        <property name="remoteServiceName" value="gwtJahiaContentManagenentService"/>
    </bean>
    <bean name="gwtJahiaContentManagenentService" class="org.jahia.ajax.gwt.content.server.JahiaContentManagementServiceImpl" scope="prototype">
    <property name="acl" ref="ACLHelper"/>
        <property name="preferencesService" ref="JahiaPreferencesService"/>
        <property name="contentDefinition" ref="ContentDefinitionHelper"/>
        <property name="contentHub" ref="ContentHubHelper"/>
        <property name="contentManager" ref="ContentManagerHelper"/>
        <property name="mashup" ref="MashupHelper"/>
        <property name="versioning" ref="VersioningHelper"/>
        <property name="navigation" ref="NavigationHelper"/>
        <property name="properties" ref="PropertiesHelper"/>
        <property name="languages" ref="LanguagesHelper"/>
        <property name="rolesPermissions" ref="RolesPermissionsHelper"/>
        <property name="publication" ref="PublicationHelper"/>
        <property name="workflow" ref="WorkflowHelper"/>
        <property name="search" ref="SearchHelper"/>
        <property name="template" ref="TemplateHelper"/>
        <property name="zip" ref="ZipHelper"/>

    </bean>

    <bean name="openSearchServiceController" class="org.jahia.ajax.gwt.commons.server.GWTController">
        <property name="remoteServiceName" value="gwtOpenSearchService"/>
    </bean>
    <bean name="gwtOpenSearchService" class="org.jahia.ajax.gwt.templates.components.opensearch.server.JahiaOpenSearchServiceImpl" scope="prototype"/>
    
    <bean name="pdisplayServiceController" class="org.jahia.ajax.gwt.commons.server.GWTController">
        <property name="remoteServiceName" value="gwtProcessDisplayService"/>
    </bean>
    <bean name="gwtProcessDisplayService" class="org.jahia.ajax.gwt.engines.pdisplay.server.ProcessDisplayServiceImpl" scope="prototype">
        <property name="preferencesService" ref="JahiaPreferencesService"/>
    </bean>
    
    <bean name="toolbarServiceController" class="org.jahia.ajax.gwt.commons.server.GWTController">
        <property name="remoteServiceName" value="gwtToolbarService"/>
    </bean>
    <bean name="gwtToolbarService" class="org.jahia.ajax.gwt.templates.components.toolbar.server.ToolbarServiceImpl" scope="prototype">
        <property name="preferencesService" ref="JahiaPreferencesService"/>
    </bean>
    
    <bean name="sessionManagerServiceController" class="org.jahia.ajax.gwt.commons.server.GWTController">
        <property name="remoteServiceName" value="gwtSessionManagerService"/>
    </bean>
    <bean name="gwtSessionManagerService" class="org.jahia.ajax.gwt.commons.server.rpc.SessionManagerServiceImpl" scope="prototype"/>
    
    <bean name="subscriptionServiceController" class="org.jahia.ajax.gwt.commons.server.GWTController">
        <property name="remoteServiceName" value="gwtSubscriptionService"/>
    </bean>
    <bean name="gwtSubscriptionService" class="org.jahia.ajax.gwt.templates.components.subscription.server.SubscriptionServiceImpl" scope="prototype">
        <property name="subscriptionService" ref="SubscriptionService"/>
    </bean>
    
    <bean name="userManagerServiceController" class="org.jahia.ajax.gwt.commons.server.GWTController">
        <property name="remoteServiceName" value="gwtUserManagerService"/>
    </bean>
    <bean name="gwtUserManagerService" class="org.jahia.ajax.gwt.commons.server.rpc.UserManagerServiceImpl" scope="prototype">
        <property name="groupManagerService" ref="JahiaGroupManagerService"/>
        <property name="userManagerService" ref="JahiaUserManagerService"/>
        <property name="sitesService" ref="JahiaSitesService"/>
    </bean>

   
    <bean name="ACLHelper" class="org.jahia.ajax.gwt.helper.ACLHelper" >
        <property name="jahiaUserManagerService" ref="JahiaUserManagerService" />
        <property name="jahiaGroupManagerService" ref="JahiaGroupManagerService" />
    </bean>

    <bean name="ContentDefinitionHelper" class="org.jahia.ajax.gwt.helper.ContentDefinitionHelper" >
        <property name="navigation" ref="NavigationHelper" />
        <property name="choiceListInitializerService" ref="choiceListInitializers"/>
    </bean>

    <bean name="ContentHubHelper" class="org.jahia.ajax.gwt.helper.ContentHubHelper" >
        <property name="sessionFactory" ref="jcrSessionFactory" />
    </bean>

    <bean name="ContentManagerHelper" class="org.jahia.ajax.gwt.helper.ContentManagerHelper" >
        <property name="navigation"  ref="NavigationHelper"/>
        <property name="captchaService"  ref="captchaService"/>
        <property name="importExport"  ref="ImportExportService"/>
        <property name="jcrService"  ref="JCRStoreService"/>
        <property name="versioning"  ref="VersioningHelper"/>
        <property name="sitesService"  ref="JahiaSitesService"/>
        <property name="properties" ref="PropertiesHelper"/>
    </bean>

    <bean name="MashupHelper" class="org.jahia.ajax.gwt.helper.MashupHelper" >
        <property name="navigation"  ref="NavigationHelper"/>
        <property name="acl" ref="ACLHelper"/>
        <property name="contentManager" ref="ContentManagerHelper"/>
        <property name="applicationsManager" ref="ApplicationsManagerService"/>
    </bean>

    <bean name="NavigationHelper" class="org.jahia.ajax.gwt.helper.NavigationHelper" >
        <property name="sessionFactory"  ref="jcrSessionFactory"/>
        <property name="jcrService"  ref="JCRStoreService"/>
        <property name="renderService" ref="RenderService"/>
        <property name="publication" ref="PublicationHelper"/>
        <property name="nodetypeIcons">
            <map>
                <entry key="unknown" value="file"/>
                <entry key="jmix:queryContent" value="query"/>
                <entry key="jmix:interactiveContent" value="interactive"/>
                <entry key="jmix:structuredContent" value="structured"/>
                <entry key="jmix:containerContent" value="contentlist"/>
                <entry key="jnt:page" value="page"/>
                <entry key="jnt:user" value="user"/>
                <entry key="jnt:group" value="user-group"/>
            </map>
        </property>
    </bean>

    <bean name="LanguagesHelper" class="org.jahia.ajax.gwt.helper.LanguageHelper"/>

    <bean name="PropertiesHelper" class="org.jahia.ajax.gwt.helper.PropertiesHelper" >
        <property name="contentDefinition" ref="ContentDefinitionHelper"/>
        <property name="contentManager" ref="ContentManagerHelper"/>
        <property name="navigation"  ref="NavigationHelper"/>
    </bean>

    <bean name="PublicationHelper" class="org.jahia.ajax.gwt.helper.PublicationHelper" >
        <property name="publicationService" ref="jcrPublicationService"/>
    </bean>

    <bean name="WorkflowHelper" class="org.jahia.ajax.gwt.helper.WorkflowHelper" >
        <property name="service" ref="workflowService"/>
    </bean>

    <bean name="RolesPermissionsHelper" class="org.jahia.ajax.gwt.helper.RolesPermissionsHelper">
    	<property name="roleManager" ref="RoleManager"/>
        <property name="userManagerService" ref="JahiaUserManagerService"/>
        <property name="groupManagerService" ref="JahiaGroupManagerService"/>
    </bean>


    <bean name="SearchHelper" class="org.jahia.ajax.gwt.helper.SearchHelper" >
        <property name="navigation"  ref="NavigationHelper"/>
        <property name="contentManager" ref="ContentManagerHelper"/>
        <property name="jcrService"  ref="JCRStoreService"/>
    </bean>

    <bean name="TemplateHelper" class="org.jahia.ajax.gwt.helper.TemplateHelper" >
        <property name="renderService" ref="RenderService"/>
    </bean>

    <bean name="VersioningHelper" class="org.jahia.ajax.gwt.helper.VersioningHelper" >
        <property name="cacheService" ref="JahiaCacheService"/>
    </bean>

    <bean name="ZipHelper" class="org.jahia.ajax.gwt.helper.ZipHelper" factory-method="getInstance" />

</beans>