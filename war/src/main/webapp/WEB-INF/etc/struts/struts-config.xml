<?xml version="1.0" encoding="ISO-8859-1" ?>


<!DOCTYPE struts-config PUBLIC
        "-//Apache Software Foundation//DTD Struts Configuration 1.1//EN"
        "http://jakarta.apache.org/struts/dtds/struts-config_1_2.dtd">


<struts-config>


    <!-- ========== Data Source Configuration =============================== -->


    <!-- ========== Form Bean Definitions =================================== -->

    <form-beans>

        <form-bean name="helloForm"
                   type="org.jahia.views.engines.helloworld.forms.HelloForm"/>

        <form-bean name="mainForm"
                   type="org.jahia.views.engines.forms.MainForm"/>

        <form-bean name="adminMainForm"
                   type="org.jahia.views.administration.forms.MainForm"/>

    </form-beans>


    <global-forwards>

        <!-- Default Core Engine : display a Jahia Page with a template -->
        <forward name="coreEngine" path="${jahia.deploy.war.servletPath}"/>

        <!-- Default errors -->
        <forward name="EnginesErrors" path="engines.errors"/>

        <!-- Default Engine Close MyEngineWin Popup -->
        <forward name="EnginesClose" path="engines.close"/>

        <!-- Default Engine Close Any Popup -->
        <forward name="EnginesCloseAnyPopup" path="engines.close-any-popup"/>

        <!-- Default Engine Apply -->
        <forward name="EnginesApply" path="engines.apply"/>

        <!-- Default Engine Apply Any Popup -->
        <forward name="EnginesApplyAnyPopup" path="engines.apply-any-popup"/>




    </global-forwards>


    <!-- ========== Action Mapping Definitions ============================== -->

    <action-mappings>

        <!-- ========== Jahia Engine Actions ================================== -->

        <!-- Jahia Default Action. Handle all unknown Struts action -->
        <action path="${jahia.deploy.war.servletPath}"
                type="org.jahia.bin.JahiaAction"
                scope="request"
                unknown="true">
        </action>

        <!-- Struts core action test -->
        <action path="/coreEngine.do"
                type="org.jahia.views.engines.coreengine.CoreAction"
                scope="request"
                input="engines.helloworld.input">
        </action>

        <!-- Hello World engine -->
        <action path="/hello"
                name="helloForm"
                type="org.jahia.views.engines.helloworld.actions.HelloAction"
                scope="request"
                input="engines.helloworld.input"
                validate="true">
            <forward name="welcome" path="engines.helloworld.welcome"/>
            <forward name="input" path="engines.helloworld.input"/>
        </action>

        <!-- Pages Versioning engine -->
        <action path="/PagesVersioning"
                name="mainForm"
                type="org.jahia.views.engines.versioning.pages.actions.PagesVersioningAction"
                scope="request"
                input="engines.versioning.pages.revisions-list"
                parameter="method"
                validate="false">
            <forward name="operationChoices" path="engines.versioning.pages.operation-choices"/>
            <forward name="sitemap" path="engines.versioning.pages.sitemap"/>
            <forward name="revisionsList" path="engines.versioning.pages.revisions-list"/>
            <forward name="confirmRestore" path="engines.versioning.pages.confirm-restore"/>
            <forward name="confirmUndoStaging" path="engines.versioning.pages.confirm-undo-staging"/>
            <forward name="confirmUndelete" path="engines.versioning.pages.confirm-page-undelete"/>
            <forward name="revisionsDetail" path="/do/RevisionEntrySetDetail?method=revisionsDetail&amp;reloaded=yes"/>
            <forward name="close" path="engines.close"/>
            <forward name="pageTreeLocked" path="engines.versioning.pages.tree-locked">
            </forward>
        </action>


        <!-- Versioning Revisions Detail -->
        <action path="/RevisionEntrySetDetail"
                name="mainForm"
                type="org.jahia.views.engines.versioning.revisionsdetail.actions.RevisionEntrySetDetailAction"
                scope="request"
                input="engines.versioning.revisionsdetail"
                parameter="method"
                validate="false">
            <forward name="revisionsDetail" path="engines.versioning.revisionsdetail"/>
        </action>

        <!-- Date Picker engine -->
        <action path="/DatePicker"
                type="org.jahia.views.engines.datepicker.actions.DatePickerAction"
                input="engines.datepicker"
                parameter="method"
                validate="false">
        </action>


        <!--=======================================================================-->
        <!-- ADMININSTRATION SECTION 											   -->
        <!--=======================================================================-->

        <!-- HTML settings -->
        <action path="/HtmlSettings"
                type="org.jahia.views.administration.actions.HtmlSettingsAction"
                scope="request"
                input="admin.htmlsettings.main"
                parameter="method"
                validate="false">
        </action>

        <!-- Integrity checks -->
        <action path="/IntegrityChecks"
                type="org.jahia.views.administration.actions.IntegrityChecksAction"
                scope="request"
                input="admin.integrity.main"
                parameter="method"
                validate="false">
        </action>

        <!-- End Jahia Actions -->

    </action-mappings>


    <!-- ===================================== Controller Configuration -->

    <controller
            processorClass="org.jahia.bin.JahiaRequestProcessor" contentType="text/html; charset=UTF-8" 
            multipartClass="org.jahia.tools.files.JahiaMultipartRequestHandler"/>
    <!-- Message Resources -->
    <message-resources parameter="ApplicationResources" null="false"/>
    <!-- Tiles PlugIns -->
    <plug-in className="org.apache.struts.tiles.TilesPlugin">
        <set-property property="definitions-config" value="/WEB-INF/etc/struts/jahia-tiles-defs.xml"/>
        <set-property property="definitions-debug" value="100"/>
        <set-property property="definitions-parser-details" value="100"/>
        <set-property property="definitions-parser-validate" value="false"/>
    </plug-in>

    <!-- Validator PlugIn -->
    <plug-in className="org.jahia.bin.JahiaValidatorPlugIn">
        <set-property property="pathnames"
                        value="/WEB-INF/etc/struts/validation.xml,/WEB-INF/etc/struts/validator-rules.xml,/WEB-INF/etc/struts/validator-jahia-rules.xml"/>
    </plug-in>

</struts-config>
