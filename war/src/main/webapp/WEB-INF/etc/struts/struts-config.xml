<?xml version="1.0" encoding="ISO-8859-1" ?>


<!DOCTYPE struts-config PUBLIC
        "-//Apache Software Foundation//DTD Struts Configuration 1.1//EN"
        "http://jakarta.apache.org/struts/dtds/struts-config_1_2.dtd">


<struts-config>


    <!-- ========== Data Source Configuration =============================== -->


    <!-- ========== Form Bean Definitions =================================== -->

    <form-beans>

        <form-bean name="helloForm"
                   type="org.jahia.views.engines.helloworld.forms.HelloForm"/>

        <form-bean name="mainForm"
                   type="org.jahia.views.engines.forms.MainForm"/>

        <form-bean name="adminMainForm"
                   type="org.jahia.views.administration.forms.MainForm"/>

    </form-beans>


    <global-forwards>

        <!-- Default Core Engine : display a Jahia Page with a template -->
        <forward name="coreEngine" path="${jahia.deploy.war.servletPath}"/>

        <!-- Default errors -->
        <forward name="EnginesErrors" path="engines.errors"/>

        <!-- Default Engine Close MyEngineWin Popup -->
        <forward name="EnginesClose" path="engines.close"/>

        <!-- Default Engine Close Any Popup -->
        <forward name="EnginesCloseAnyPopup" path="engines.close-any-popup"/>

        <!-- Default Engine Apply -->
        <forward name="EnginesApply" path="engines.apply"/>

        <!-- Default Engine Apply Any Popup -->
        <forward name="EnginesApplyAnyPopup" path="engines.apply-any-popup"/>

        <!-- Struts faces test -->
        <forward name="sayHello" path="/jsp/sayHello.faces"/>



    </global-forwards>


    <!-- ========== Action Mapping Definitions ============================== -->

    <action-mappings>

        <!-- ========== Jahia Engine Actions ================================== -->

        <!-- Jahia Default Action. Handle all unknown Struts action -->
        <action path="${jahia.deploy.war.servletPath}"
                type="org.jahia.bin.JahiaAction"
                scope="request"
                unknown="true">
        </action>

        <!-- Struts core action test -->
        <action path="/coreEngine.do"
                type="org.jahia.views.engines.coreengine.CoreAction"
                scope="request"
                input="engines.helloworld.input">
        </action>

        <!-- Struts faces test -->
        <action path="/sayHello"
                type="org.jahia.views.engines.SayHelloAction"
                scope="request"
                input="sayHello">
        </action>

        <!-- Hello World engine -->
        <action path="/hello"
                name="helloForm"
                type="org.jahia.views.engines.helloworld.actions.HelloAction"
                scope="request"
                input="engines.helloworld.input"
                validate="true">
            <forward name="welcome" path="engines.helloworld.welcome"/>
            <forward name="input" path="engines.helloworld.input"/>
        </action>

        <!-- Pages Versioning engine -->
        <action path="/PagesVersioning"
                name="mainForm"
                type="org.jahia.views.engines.versioning.pages.actions.PagesVersioningAction"
                scope="request"
                input="engines.versioning.pages.revisions-list"
                parameter="method"
                validate="false">
            <forward name="operationChoices" path="engines.versioning.pages.operation-choices"/>
            <forward name="sitemap" path="engines.versioning.pages.sitemap"/>
            <forward name="revisionsList" path="engines.versioning.pages.revisions-list"/>
            <forward name="confirmRestore" path="engines.versioning.pages.confirm-restore"/>
            <forward name="confirmUndoStaging" path="engines.versioning.pages.confirm-undo-staging"/>
            <forward name="confirmUndelete" path="engines.versioning.pages.confirm-page-undelete"/>
            <forward name="revisionsDetail" path="/do/RevisionEntrySetDetail?method=revisionsDetail&amp;reloaded=yes"/>
            <forward name="close" path="engines.close"/>
            <forward name="pageTreeLocked" path="engines.versioning.pages.tree-locked">
            </forward>
        </action>

        <!-- Container Versioning engine -->
        <action path="/ContainerVersioning"
                name="mainForm"
                type="org.jahia.views.engines.versioning.actions.ContentVersioningAction"
                scope="request"
                input="engines.versioning.container.revisions-list"
                parameter="method"
                validate="false">
            <forward name="operationChoices" path="engines.versioning.container.operation-choices"/>
            <forward name="revisionsList" path="engines.versioning.container.revisions-list"/>
            <forward name="containerVersionCompare" path="engines.versioning.container.compare-version"/>
            <forward name="confirmRestore" path="engines.versioning.container.confirm-restore"/>
            <forward name="confirmUndoStaging" path="engines.versioning.container.confirm-undo-staging"/>
            <forward name="confirmUndelete" path="engines.versioning.container.confirm-undelete"/>
            <forward name="close" path="engines.close"/>
        </action>

        <!-- Container Versioning engine -->
        <action path="/ContainerListVersioning"
                name="mainForm"
                type="org.jahia.views.engines.versioning.actions.ContainerListVersioningAction"
                scope="request"
                input="engines.versioning.containerlist.containers-list"
                parameter="method"
                validate="false">
            <forward name="operationChoices" path="engines.versioning.containerlist.operation-choices"/>
            <forward name="containersList" path="engines.versioning.containerlist.containers-list"/>
            <forward name="revisionsList" path="engines.versioning.containerlist.revisions-list"/>
            <forward name="confirmRestore" path="engines.versioning.containerlist.confirm-restore"/>
            <forward name="confirmUndoStaging" path="engines.versioning.containerlist.confirm-undo-staging"/>
            <forward name="containerVersionDetail" path="engines.versioning.containerlist.containerversiondetail"/>
            <forward name="confirmUndelete" path="engines.versioning.containerlist.confirm-undelete"/>
            <forward name="close" path="engines.close"/>
        </action>

        <!-- Versioning Revisions Detail -->
        <action path="/RevisionEntrySetDetail"
                name="mainForm"
                type="org.jahia.views.engines.versioning.revisionsdetail.actions.RevisionEntrySetDetailAction"
                scope="request"
                input="engines.versioning.revisionsdetail"
                parameter="method"
                validate="false">
            <forward name="revisionsDetail" path="engines.versioning.revisionsdetail"/>
        </action>

        <!-- Date Picker engine -->
        <action path="/DatePicker"
                type="org.jahia.views.engines.datepicker.actions.DatePickerAction"
                input="engines.datepicker"
                parameter="method"
                validate="false">
        </action>

        <!-- Metadata engine -->
        <action path="/MetadataAction"
                name="mainForm"
                type="org.jahia.views.engines.metadata.MetadataAction"
                scope="request"
                input="engines.metadata.edit"
                parameter="method"
                validate="false">
            <forward name="edit" path="engines.metadata.edit"/>
        </action>

        <!-- Ajax Actions -->
        <action path="/GetServerTime"
                type="org.jahia.ajax.serverdatetime.GetServerTimeAction"
                parameter="method"
                validate="false">
        </action>

        <action path="/GetClientServerTimeDiff"
                type="org.jahia.ajax.serverdatetime.GetClientServerTimeDiffAction"
                parameter="method"
                validate="false">
        </action>

        <action path="/GetMenuItems"
                type="org.jahia.ajax.actionmenus.GetMenuItemsAction"
                parameter="method"
                validate="false">
        </action>

        <action path="/usersettings"
                type="org.jahia.ajax.usersession.userSettings"
                parameter="method"
                validate="false">
        </action>

        <action path="/PDisp"
                type="org.jahia.ajax.monitors.PDisplayAction"
                parameter="method"
                validate="false">
        </action>

        <action path="/GetChildPages"
            type="org.jahia.ajax.sitemap.GetChildPages"
                parameter="method"
                validate="false">
        </action>

        <action path="/GetChildPagesEntryPoint"
            type="org.jahia.ajax.sitemap.GetChildPagesEntryPoint"
                parameter="method"
                validate="false">
        </action>

        <action path="/GetWorkflowState"
            type="org.jahia.ajax.actionmenus.GetWorkflowState"
                parameter="method"
                validate="false">
        </action>

        <action path="/GetExtendedWorkflowState"
            type="org.jahia.ajax.actionmenus.GetExtendedWorkflowStateAction"
                parameter="method"
                validate="false">
        </action>

        <action path="/GetTimeBasedPublishingState"
            type="org.jahia.ajax.actionmenus.GetTimeBasedPublishingState"
                parameter="method"
                validate="false">
        </action>

        <action path="/GetCategories"
                type="org.jahia.ajax.categories.GetCategories"
                parameter="method"
                validate="false">
        </action>

        <action path="/GetCategoryChildren"
                type="org.jahia.ajax.categories.GetCategoryChildren"
                parameter="method"
                validate="false">
        </action>

        <action path="/GetQuotedPrintable"
                type="org.jahia.ajax.GetQuotedPrintableStringAction"
                parameter="method"
                validate="false">
        </action>

        <action path="/GetPatchesStatus"
            type="org.jahia.ajax.admin.PatchStatusAction"
                parameter="method"
                validate="false">
        </action>
        
        <action path="/ReleaseLock"
            type="org.jahia.ajax.engines.ReleaseLock"
                validate="false">
        </action>

        <action path="/QuickValidate"
            type="org.jahia.ajax.actionmenus.QuickValidationAction"
                validate="false">
        </action>

        <action path="/GetTreeCategory"
                type="org.jahia.ajax.categories.GetTreeCategory"
                parameter="method"
                validate="false" />

        <action path="/IsCategoryKeyValid"
                type="org.jahia.ajax.categories.IsCategoryKeyValid" 
                parameter="method"
                validate="false" />
                
        <action path="/SearchAutoFullFill"
                type="org.jahia.ajax.search.SearchAutoFullFillAction"
                parameter="method"
                validate="false">
        </action>

        <action path="/IndexSite"
            type="org.jahia.ajax.admin.IndexSiteAction"
                validate="false">
        </action>
        
        <action path="/subscription"
            type="org.jahia.ajax.subscriptions.SubscribeAction"
                parameter="action"
                validate="false">
        </action>

        <!--=======================================================================-->
        <!-- ADMININSTRATION SECTION 											   -->
        <!--=======================================================================-->

        <!-- HTML settings -->
        <action path="/HtmlSettings"
                type="org.jahia.views.administration.actions.HtmlSettingsAction"
                scope="request"
                input="admin.htmlsettings.main"
                parameter="method"
                validate="false">
        </action>

        <!-- Integrity checks -->
        <action path="/IntegrityChecks"
                type="org.jahia.views.administration.actions.IntegrityChecksAction"
                scope="request"
                input="admin.integrity.main"
                parameter="method"
                validate="false">
        </action>

        <!-- End Jahia Actions -->

    </action-mappings>


    <!-- ===================================== Controller Configuration -->

    <controller
            processorClass="org.jahia.bin.JahiaRequestProcessor" contentType="text/html; charset=UTF-8" 
            multipartClass="org.jahia.tools.files.JahiaMultipartRequestHandler"/>
    <!-- Message Resources -->
    <message-resources parameter="ApplicationResources" null="false"/>
    <!-- Tiles PlugIns -->
    <plug-in className="org.apache.struts.tiles.TilesPlugin">
        <set-property property="definitions-config" value="/WEB-INF/etc/struts/jahia-tiles-defs.xml"/>
        <set-property property="definitions-debug" value="100"/>
        <set-property property="definitions-parser-details" value="100"/>
        <set-property property="definitions-parser-validate" value="false"/>
    </plug-in>

    <!-- Validator PlugIn -->
    <plug-in className="org.apache.struts.validator.ValidatorPlugIn">
        <set-property property="pathnames"
                      value="/WEB-INF/etc/struts/validator-rules.xml,
   			       /WEB-INF/etc/struts/validator-jahia-rules.xml"/>
    </plug-in>

</struts-config>
