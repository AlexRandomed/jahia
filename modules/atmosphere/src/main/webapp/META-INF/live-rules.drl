package org.jahia.modules.atmosphere.rules

#list any import classes here.
import org.jahia.services.content.rules.*
import org.jahia.services.content.*
import org.jahia.services.atmosphere.rules.*
import javax.jcr.observation.Event
import org.slf4j.Logger

expander rules.dsl

#declare any global variables here
global User user
global Service service
global ImageService imageService
global ExtractionService extractionService
global Logger logger
global JCRStoreProvider provider
global SitePublisherSubscriberRuleService sitePubSubService


rule "Send a site message on editorial content creation"
    salience 50
    when
        A new node is created
            - the node has the type jmix:editorialContent
            - installed modules contains atmosphere
    then
        Send site message with parameters new Object[] { "label.atmosphere.editorial.content.creation", node.getName(), node.getPath() }
end


rule "Send a node message on editorial content update"
    salience 50
    when
        A property has been set on a node
            - the node has the type jmix:editorialContent
            - installed modules contains atmosphere
    then
        Send message to node channel with parameters new Object[] { "label.atmosphere.editorial.content.update", node.getName(), node.getPath() }
end