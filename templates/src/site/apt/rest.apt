Basic Jahia REST API

* Quick introduction

 Jahia provides a REST API, mostly for rendering, but some other services are available as well such: login,
 logout, content creation & updating and searching.

* Examples

 You can find an example of some REST API calls in the file templates/default/examples/jqueryfind.html. To test this
 file, make sure you start & configure your Jahia, and then point your browser to the following URL :

 http://localhost:8080/templates/default/examples/jqueryfind.html

* Login

 URL : /cms/login

 Method : POST

 Parameters :

*----------------+-------------+------------------------------------------------+
|Name            |Mandatory    |Description                                     |
*----------------+-------------+------------------------------------------------+
|username        |yes          |The username of the user that you want to login |
*----------------+-------------+------------------------------------------------+
|password        |yes          |The user's password                             |
*----------------+-------------+------------------------------------------------+
|redirectActive  |no           |If set to "true" or not set, the login servlet  |
|                |             |will redirect to the home page after successful |
|                |             |authentification. If you are using AJAX calls   |
|                |             |you should set this to "false".                 |
*----------------+-------------+------------------------------------------------+
|loginFromTag    |yes          |Should always be set to "1" otherwise login will|
|                |             |not work                                        |
*----------------+-------------+------------------------------------------------+
|redirect        |no           |Allows you to specify another URL to redirect   |
|                |             |after successful login                          |
*----------------+-------------+------------------------------------------------+

* Logout

 URL : /cms/logout

 Method : POST

*----------------+-------------+------------------------------------------------+
|Name            |Mandatory    |Description                                     |
*----------------+-------------+------------------------------------------------+
|redirectActive  |no           |If set to "true" or not set, the login servlet  |
|                |             |will redirect to the home page after successful |
|                |             |authentification. If you are using AJAX calls   |
|                |             |you should set this to "false".                 |
*----------------+-------------+------------------------------------------------+
|redirect        |no           |Allows you to specify another URL to redirect   |
|                |             |after successful login                          |
*----------------+-------------+------------------------------------------------+

 TBD

* Render

 URL : /cms/render/WORKSPACE/LANGUAGE/CONTENT_PATH

 Method : POST

 TBD

* Find

 URL : /cms/find/WORKSPACE/LANGUAGE

 Method : POST or GET

 Parameters :
 
*---------------------------+-------------+----------------------------------------------------------------------+
|Name                       |Mandatory    |Description                                                           |
*---------------------------+-------------+----------------------------------------------------------------------+
|query                      |yes          |The JCR query to execute. You can reference request parameters in your|
|                           |             |query by using the following syntax : {$paramName} which will look for|
|                           |             |a request parameter called "paramName"                                |
*---------------------------+-------------+----------------------------------------------------------------------+
|language                   |no           |The JCR language used in the query, for example "JCR-SQL2" or "xpath" |
|                           |             |Defaults to "JCR-SQL2"                                                |
*---------------------------+-------------+----------------------------------------------------------------------+
|limit                      |no           |The maximum number of results to return.                              |
|                           |             |Defaults to 0 that does not limit the results.                        |
*---------------------------+-------------+----------------------------------------------------------------------+
|offset                     |no           |The 0-index based offset to start results with.                       |
|                           |             |Defaults to 0.                                                        |
*---------------------------+-------------+----------------------------------------------------------------------+
|depthLimit                 |no           |The depth of the result tree. If not set it defaults to "1". If you   |
|                           |             |have deep content tree hierarchies you might want to limit result     |
|                           |             |depth to avoid performance issues.                                    |
*---------------------------+-------------+----------------------------------------------------------------------+
|escapeColon                |no           |If set to true, the ':' in the node property name will be replaced    |
|                           |             | '_'.                                                                 |
|                           |             |Defaults to false.                                                    |
*---------------------------+-------------+----------------------------------------------------------------------+
|propertyMatchRexexp        |no           |The value you specify here will be used to match properties in the    |
|                           |             |result set, and will build a matchingProperties JSON list that will   |
|                           |             |let you known which properties have matched. This is especially useful|
|                           |             |when using fulltext search, since the JCR doesn't indicate which      |
|                           |             |property has matched the criteria. The value you specify must comply  |
|                           |             |with the JDK Pattern Regexp syntax.                                   |
*---------------------------+-------------+----------------------------------------------------------------------+
|removeDuplicatePropValues  |no           |If activated, it will filter the matched properties (that were        |
|                           |             |matched using the propertyMatchRegexp above parameter) to make sure   |
|                           |             |only one node per property value is returned. This is useful when     |
|                           |             |building unique list of property values for auto-completion.          |
|                           |             |Defaults to false.                                                    |
*---------------------------+-------------+----------------------------------------------------------------------+

 Example query (formatted for legibility) :

---------------------------------------
 http://localhost:8080/cms/find/default/en
 ?q=t
 &limit=10
 &query=%2Fjcr%3Aroot%2Fsites%2FmySite%2Ftags%2F%2Felement(*%2C+jnt%3Atag)%5Bjcr%3Acontains(.%2C'%7B%24q%7D*')%5D%2F%40j%3Anodename
 &language=xpath
 &escapeColon=false
 &propertyMatchRegexp=%7B%24q%7D.*
 &removeDuplicatePropValues=false
---------------------------------------

 In the above example, the values are encoded so that makes a bit harder to read. Here are the unencoded values :

---------------------------------------
 query = /jcr:root/sites/mySite/tags//element(*, jnt:tag)[jcr:contains(.,'{$q}*')]/@j:nodename
 propertyMatchRegexp = {$q}.*
---------------------------------------

 One important thing is to now the {$q} marker that will actually be replaced with the value of the "q" request parameter
 specified in the request. This makes it easy to integrate with JQuery plugins that might use specific named request
 parameters.

 Response :

---------------------------------------
Content-Length:1721
Content-Type:application/json;charset=UTF-8
Date:Fri, 26 Feb 2010 13:31:38 GMT
Server:Apache-Coyote/1.1
[
	{
		"jcr:score": "1366",
		"node": {
			"index": 1,
			"jcr:createdBy": "root",
			"jcr:baseVersion": "/repository/default/jcr:system/jcr:versionStorage/5b/92/d7/5b92d76a-ee40-4b17-87e6-911a38db2ddb/jcr:rootVersion",
			"jcr:versionHistory": "/repository/default/jcr:system/jcr:versionStorage/5b/92/d7/5b92d76a-ee40-4b17-87e6-911a38db2ddb",
			"depth": 4,
			"jcr:lastModifiedBy": "root",
			"primaryNodeType": "jnt:tag",
			"j:nodename": "tag1",
			"j:originWS": "default",
			"jcr:isCheckedOut": "true",
			"jcr:lastModified": "2010-02-26T12:14:14.502+01:00",
			"matchingProperties": [
				"j:nodename",
				"jcr:isCheckedOut"
			],
			"jcr:created": "2010-02-26T12:14:14.397+01:00",
			"j:fullpath": "/sites/mySite/tags/tag1",
			"jcr:uuid": "5b92d76a-ee40-4b17-87e6-911a38db2ddb",
			"jcr:primaryType": "jnt:tag",
			"identifier": "5b92d76a-ee40-4b17-87e6-911a38db2ddb",
			"path": "/sites/mySite/tags/tag1"
		},
		"j:nodename": "tag1",
		"jcr:path": "/sites/mySite/tags/tag1"
	},
	{
		"jcr:score": "1366",
		"node": {
			"index": 1,
			"jcr:createdBy": "root",
			"jcr:baseVersion": "/repository/default/jcr:system/jcr:versionStorage/ab/63/bb/ab63bb78-8708-48aa-a040-82eee22ae5d7/jcr:rootVersion",
			"jcr:versionHistory": "/repository/default/jcr:system/jcr:versionStorage/ab/63/bb/ab63bb78-8708-48aa-a040-82eee22ae5d7",
			"depth": 4,
			"jcr:lastModifiedBy": "root",
			"primaryNodeType": "jnt:tag",
			"j:nodename": "tag2",
			"j:originWS": "default",
			"jcr:isCheckedOut": "true",
			"jcr:lastModified": "2010-02-26T12:14:18.570+01:00",
			"matchingProperties": [
				"j:nodename",
				"jcr:isCheckedOut"
			],
			"jcr:created": "2010-02-26T12:14:18.477+01:00",
			"j:fullpath": "/sites/mySite/tags/tag2",
			"jcr:uuid": "ab63bb78-8708-48aa-a040-82eee22ae5d7",
			"jcr:primaryType": "jnt:tag",
			"identifier": "ab63bb78-8708-48aa-a040-82eee22ae5d7",
			"path": "/sites/mySite/tags/tag2"
		},
		"j:nodename": "tag2",
		"jcr:path": "/sites/mySite/tags/tag2"
	}
]
---------------------------------------
