<?xml version="1.0" encoding="UTF-8"?>
<project>
  <modelVersion>4.0.0</modelVersion>
  <artifactId>jahia-root</artifactId>
  <name>Jahia Project Root</name>
  <groupId>org.jahia.server</groupId>
  <version>6.5-SNAPSHOT</version>
  <packaging>pom</packaging>
  <inceptionYear>2004</inceptionYear>
  <!--logo>/images/jahia.gif</logo-->
  <description>Jahia Full Package</description>
  <url>http://www.jahia.org</url>
  <properties>
    <pluto.version>2.0.0</pluto.version>
    <spring.version>2.5.6</spring.version>
    <jackrabbit.version>2.0-alpha10</jackrabbit.version>
    <lucene.version>2.4.1</lucene.version>
    <jahia.package.version>6.5-SNAPSHOT</jahia.package.version>

    <driver.derby.version>10.4.2.0</driver.derby.version>
    <driver.hsqldb.version>1.8.0.7</driver.hsqldb.version>
    <driver.mssql.version>1.2-fixed</driver.mssql.version>
    <driver.mysql.version>5.1.9</driver.mysql.version>
    <driver.oracle.version>11.2.0.1.0</driver.oracle.version>
    <driver.postgresql.version>8.4-701.jdbc3</driver.postgresql.version>

    <drivers.libs.scope>compile</drivers.libs.scope> <!-- include DB driver JARs into jahia.war/WEB-INF/lib -->
    <jboss.libs.scope>compile</jboss.libs.scope> <!-- include jboss-*.jar files into jahia.war/WEB-INF/lib -->
    <jahia.war.classifier></jahia.war.classifier>
    <!-- MANIFEST.MF information -->
    <jahia.manifest.vendor.name>Jahia Solutions Group SA</jahia.manifest.vendor.name>
    <jahia.manifest.vendor.id>org.jahia</jahia.manifest.vendor.id>
    <jahia.manifest.vendor.url>http://www.jahia.org</jahia.manifest.vendor.url>
  </properties>

  <scm>
    <connection>scm:svn:http://10.8.37.111/svn/jahia/trunk/</connection>
    <developerConnection>scm:svn:http://10.8.37.111/svn/jahia/trunk/</developerConnection>
    <url>http://10.8.37.111/svn/jahia/trunk</url>
  </scm>

  <repositories>
    <repository>
      <releases>
        <enabled>true</enabled>
      </releases>
      <snapshots>
        <enabled>true</enabled>
      </snapshots>
      <id>jahiaRepository</id>
      <name>Jahia's Maven Repository</name>
      <url>http://maven.jahia.org/maven2</url>
    </repository>
  </repositories>

  <pluginRepositories>
    <pluginRepository>
      <releases>
        <enabled>true</enabled>
      </releases>
      <id>jahiaRepository</id>
      <name>Jahia's Maven Repository</name>
      <url>http://maven.jahia.org/maven2</url>
    </pluginRepository>
  </pluginRepositories>

    <profiles>

      <profile>
          <id>code-coverage</id>
          <build>
              <plugins>
                  <plugin>
                      <groupId>com.atlassian.maven.plugins</groupId>
                      <artifactId>maven-clover2-plugin</artifactId>
                      <configuration>
                          <generateHistorical>false</generateHistorical>
                          <targetPercentage>7%</targetPercentage>
                          <!--<generateXml>true</generateXml>-->
                          <generatePdf>true</generatePdf>
                          <!--
                          <cloverDatabase>/foo/bar</cloverDatabase>
                          <cloverMergeDatabase>/foo/bar</cloverMergeDatabase>
                          -->
                          <excludes>
                              <exclude>**/org/jahia/ajax/gwt/client/**/*.java</exclude>
                              <exclude>**/org/jahia/ajax/gwt/module/**/*.java</exclude>
                              <exclude>**/org/jahia/ajax/gwt/template/**/*.java</exclude>
                              <exclude>org/jahia/ajax/gwt/client/**/*.java</exclude>
                              <exclude>org/jahia/ajax/gwt/module/**/*.java</exclude>
                              <exclude>org/jahia/ajax/gwt/template/**/*.java</exclude>
                          </excludes>
                      </configuration>
                      <executions>
                          <execution>
                              <id>clover-prepare</id>
                              <phase>generate-sources</phase>
                              <goals>
                                  <goal>setup</goal>
                              </goals>
                          </execution>
                          <execution>
                              <id>clover-report</id>
                              <phase>verify</phase>
                              <goals>
                                  <goal>aggregate</goal>
                                  <goal>save-history</goal>
                                  <goal>clover</goal>
                              </goals>
                          </execution>
                      </executions>
                  </plugin>
              </plugins>
          </build>
      </profile>

        <profile>
            <id>license</id>
            <build>
                <plugins>
                    <plugin>
                        <groupId>com.google.code.maven-license-plugin</groupId>
                        <artifactId>maven-license-plugin</artifactId>
                        <version>1.4.0</version>
                        <configuration>
                            <basedir>${basedir}</basedir>
                            <header>header.txt</header>
                            <quiet>false</quiet>
                            <failIfMissing>true</failIfMissing>
                            <aggregate>true</aggregate>
                            <includes>
                                <include>src/**/*.java</include>
                                <include>src/**/*.tag</include>
                                <include>src/**/*.jsp</include>
                                <include>src/**/*.jspf</include>
                                <include>src/**/*.inc</include>
                            </includes>
                            <excludes>
                                <exclude>src/main/java/compressionFilters/**</exclude>
                                <exclude>src/main/java/name/fraser/**</exclude>
                                <exclude>src/main/java/org/apache/**</exclude>
                                <exclude>src/main/java/EDU/oswego/**</exclude>
                            </excludes>
                            <useDefaultExcludes>true</useDefaultExcludes>
                            <mapping>
                                <tag>DYNASCRIPT_STYLE</tag>
                                <inc>DYNASCRIPT_STYLE</inc>
                                <jspf>DYNASCRIPT_STYLE</jspf>
                            </mapping>
                            <useDefaultMapping>true</useDefaultMapping>
                            <properties>
                                <year>2009</year>
                            </properties>
                            <encoding>UTF-8</encoding>
                            <headerDefinitions>
                                <headerDefinition>style.xml</headerDefinition>
                            </headerDefinitions>
                        </configuration>
                        <executions>
                            <execution>
                                <phase>validate</phase>
                                <goals>
                                    <goal>format</goal>
                                </goals>
                            </execution>
                        </executions>
                    </plugin>
                </plugins>
            </build>
        </profile>

        <profile>
            <id>jboss-deployment</id>
            <activation>
                <property>
                    <name>jahia.deploy.targetServerType</name>
                    <value>jboss</value>
                </property>
            </activation>
            <properties>
                <jboss.libs.scope>provided</jboss.libs.scope> <!-- do not include DB driver JARs into jahia.war/WEB-INF/lib; they will be included into jahia.ear/ -->
                <drivers.libs.scope>provided</drivers.libs.scope> <!-- do not include jboss-*.jar files into jahia.war/WEB-INF/lib; JBoss already contains them -->
                <jahia.war.classifier>jboss</jahia.war.classifier>
            </properties>
            <modules>
                <module>deployments</module>
            </modules>
        </profile>

        <profile>
            <id>qa-build</id>
            <modules>
                <module>configwizard-webapp</module>
                <module>package</module>
            </modules>
        </profile>
        <profile>
            <id>qa-jboss</id>
            <modules>
                <module>package</module>
            </modules>
        </profile>
    </profiles>

  <modules>
    <module>public-api</module>
    <module>bridges</module>
    <module>taglib</module>
    <module>jackrabbit-ext</module>
    <module>core</module>
    <module>test</module>
    <module>gwt</module>
    <module>templates</module>
    <module>prepackagedSites</module>
    <module>war</module>
    <!--<module>ear</module>-->
  </modules>

    <distributionManagement>
        <repository>
            <id>jahiaRepository</id>
            <url>scpexe://maven.jahia.org/var/www/vhosts/maven.jahia.org/html/maven2</url>
        </repository>
        <site>
            <id>jahia.website</id>
            <url>file://${jahia.site.path}</url>
        </site>
    </distributionManagement>


  <build>
    <plugins>

        <plugin>
           <groupId>org.apache.maven.plugins</groupId>
           <artifactId>maven-enforcer-plugin</artifactId>
            <executions>
          <execution>
            <id>enforce-versions</id>
            <goals>
              <goal>enforce</goal>
            </goals>
            <configuration>
              <rules>
                <requireMavenVersion>
                  <version>2.1</version>
                </requireMavenVersion>
                <requireJavaVersion>
                  <version>1.5</version>
                </requireJavaVersion>
              </rules>
            </configuration>
          </execution>
        </executions>         </plugin>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-compiler-plugin</artifactId>
        <configuration>
          <!-- put your configurations here -->
          <source>1.5</source>
          <target>1.5</target>
        </configuration>
      </plugin>
      <plugin>
        <groupId>org.codehaus.mojo</groupId>
        <artifactId>buildnumber-maven-plugin</artifactId>
        <version>1.0-beta-3</version>
        <executions>
          <execution>
            <phase>validate</phase>
            <goals>
              <goal>create</goal>
            </goals>
          </execution>
        </executions>
        <configuration>
          <doCheck>false</doCheck>
          <doUpdate>false</doUpdate>
          <useLastCommittedRevision>true</useLastCommittedRevision>
          <getRevisionOnlyOnce>true</getRevisionOnlyOnce>
          <!-- seems this doesn't work well yet, but maybe in a new future ?
          <providerImplementations>
            <svn>javasvn</svn>
          </providerImplementations>
           -->
        </configuration>
      </plugin>
    </plugins>
  </build>
    <reporting>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-project-info-reports-plugin</artifactId>
                <reportSets>
                    <reportSet>
                        <reports>
                            <report>project-team</report>
                            <report>mailing-list</report>
                            <report>cim</report>
                            <report>issue-tracking</report>
                            <report>license</report>
                            <report>scm</report>
                        </reports>
                    </reportSet>
                </reportSets>
            </plugin>            
        </plugins>
    </reporting>
</project>
